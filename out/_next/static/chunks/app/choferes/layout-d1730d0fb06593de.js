(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3713],{9650:(e,t,r)=>{"use strict";let a,o,i,l,n;r.d(t,{j2:()=>o,db:()=>i,BV:()=>n,IG:()=>l});var u=r(23915),s=r(93004),c=r(35317),d=r(90858),g=r(20996);a=0===(0,u.Dk)().length?(0,u.Wp)({apiKey:"AIzaSyBuA8vYdEeoAhtTkYz1mPfu8l_e8eIpeFY",authDomain:"ultimahora-8cdd7.firebaseapp.com",projectId:"ultimahora-8cdd7",storageBucket:"ultimahora-8cdd7.appspot.com",messagingSenderId:"64761922059",appId:"1:64761922059:web:97a111af73246f946e3d0e",measurementId:"G-E6QJLPFG3N"}):(0,u.Dk)()[0],o=(0,s.xI)(a),i=(0,c.aU)(a),l=(0,d.c7)(a),(0,g.TT)().then(e=>{if(e)try{n=(0,g.dG)(a)}catch(e){console.error("Error al iniciar Firebase Messaging:",e)}else console.warn("Firebase Messaging no soportado en este navegador.")}).catch(e=>{console.error("Error al verificar soporte de Messaging:",e)})},67968:(e,t,r)=>{Promise.resolve().then(r.bind(r,87586))},84105:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,O:()=>u});var a=r(95155),o=r(12115),i=r(9650),l=r(93004);let n=(0,o.createContext)(void 0),u=e=>{let{children:t}=e,[r,u]=(0,o.useState)(null),[s,c]=(0,o.useState)(!1),[d,g]=(0,o.useState)(!1),[h,m]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{let e=(0,l.hg)(i.j2,async e=>{if(m(!0),e){u(e),c(["erolando134@gmail.com","ortegakarelia5@gmail.com"].includes(e.email||""));try{let t=await e.getIdTokenResult();g(!!t.claims.supervisor)}catch(e){console.error("Error getting supervisor claim:",e),g(!1)}}else u(null),c(!1),g(!1);m(!1)});return()=>e()},[]),(0,a.jsx)(n.Provider,{value:{user:r,isAdmin:s,isSupervisor:d,loading:h,login:(e,t)=>(0,l.x9)(i.j2,e,t),logout:()=>(0,l.CI)(i.j2)},children:t})},s=()=>{let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},87586:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var a=r(12115),o=r(35317),i=r(9650),l=r(84105);function n(){let{user:e}=(0,l.A)(),{location:t}=function(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!navigator.geolocation)return void o("Geolocalizaci\xf3n no soportada.");let e=navigator.geolocation.watchPosition(e=>{t({lat:e.coords.latitude,lng:e.coords.longitude})},e=>{o("Error al obtener ubicaci\xf3n."),console.error(e)},{enableHighAccuracy:!0,maximumAge:1e4,timeout:1e4});return()=>navigator.geolocation.clearWatch(e)},[]),{location:e,error:r}}();return(0,a.useEffect)(()=>{if(!(null==e?void 0:e.uid)||!t)return;let r=(0,o.H9)(i.db,"drivers",e.uid);(0,o.mZ)(r,{ubicacion:{lat:t.lat,lng:t.lng,updatedAt:Date.now()},lastUpdated:(0,o.O5)()}).catch(e=>{console.error("Error actualizando ubicaci\xf3n del ch\xf3fer:",e)})},[null==e?void 0:e.uid,t]),null}}},e=>{e.O(0,[2992,7138,8248,9398,8441,5964,7358],()=>e(e.s=67968)),_N_E=e.O()}]);