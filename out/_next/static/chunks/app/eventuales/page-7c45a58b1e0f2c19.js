(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4425],{9650:(e,t,a)=>{"use strict";let s,r,n,o,i;a.d(t,{j2:()=>r,db:()=>n,BV:()=>i,IG:()=>o});var l=a(23915),c=a(93004),u=a(35317),d=a(90858),m=a(20996);s=0===(0,l.Dk)().length?(0,l.Wp)({apiKey:"AIzaSyBuA8vYdEeoAhtTkYz1mPfu8l_e8eIpeFY",authDomain:"ultimahora-8cdd7.firebaseapp.com",projectId:"ultimahora-8cdd7",storageBucket:"ultimahora-8cdd7.appspot.com",messagingSenderId:"64761922059",appId:"1:64761922059:web:97a111af73246f946e3d0e",measurementId:"G-E6QJLPFG3N"}):(0,l.Dk)()[0],r=(0,c.xI)(s),n=(0,u.aU)(s),o=(0,d.c7)(s),(0,m.TT)().then(e=>{if(e)try{i=(0,m.dG)(s)}catch(e){console.error("Error al iniciar Firebase Messaging:",e)}else console.warn("Firebase Messaging no soportado en este navegador.")}).catch(e=>{console.error("Error al verificar soporte de Messaging:",e)})},73434:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(95155),r=a(12115),n=a(84105),o=a(87481),i=a(35317),l=a(9650);function c(){let[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(1),[c,u]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),{toast:p}=(0,o.d)();async function h(s){if(s.preventDefault(),!e.trim()||!c.trim()||a<1)return void p({title:"Campos incompletos",description:"Por favor completa todos los campos correctamente.",variant:"destructive"});m(!0);try{let s=(0,i.rJ)(l.db,"solicitudes_eventuales");await (0,i.gS)(s,{nombre:e,asientos:a,telefono:c,creadoEn:i.Dc.now(),estado:"pendiente"}),p({title:"Solicitud enviada",description:"Tu solicitud fue enviada correctamente."}),t(""),n(1),u("")}catch(e){p({title:"Error",description:"Hubo un problema enviando la solicitud.",variant:"destructive"})}finally{m(!1)}}return(0,s.jsxs)("form",{onSubmit:h,className:"max-w-md w-full space-y-6 bg-gray-800 p-6 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-1",children:"Nombre Completo"}),(0,s.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full p-2 rounded text-black",placeholder:"Tu nombre completo"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-1",children:"Cantidad de Asientos"}),(0,s.jsx)("input",{type:"number",value:a,min:1,onChange:e=>n(Number(e.target.value)),required:!0,className:"w-full p-2 rounded text-black",placeholder:"N\xfamero de asientos"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-1",children:"Tel\xe9fono de Contacto"}),(0,s.jsx)("input",{type:"tel",value:c,onChange:e=>u(e.target.value),required:!0,className:"w-full p-2 rounded text-black",placeholder:"Tu tel\xe9fono"})]}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"btn-primary w-full py-2 rounded",children:d?"Enviando...":"Enviar Solicitud"})]})}let u="choferes_eventuales";async function d(e,t){let a=(0,i.H9)(l.db,u,e),s=i.Dc.now();await (0,i.BN)(a,{uid:e,depositoTimestamp:s,activo:!0,telefono:t,creadoEn:s},{merge:!0})}async function m(e){let t=(0,i.H9)(l.db,u,e),a=await (0,i.x7)(t);return a.exists()?a.data():null}function p(){let{user:e}=(0,n.A)(),[t,a]=(0,r.useState)(!1),[o,i]=(0,r.useState)(!0),[l,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(""),[f,x]=(0,r.useState)(null);async function b(){if(x(null),!p)return void x("Por favor ingresa tu n\xfamero de tel\xe9fono.");if(!e)return void x("Usuario no identificado.");try{await d(e.uid,p),a(!0),u(!1)}catch(e){x("Error registrando dep\xf3sito, intenta de nuevo.")}}return((0,r.useEffect)(()=>{if(!e){i(!1),a(!1);return}!async function(){i(!0);let t=await m(e.uid);if(!t){a(!1),u(!1),i(!1);return}let s=t.depositoTimestamp.toDate().getTime();Date.now()-s<144e5&&t.activo?(a(!0),u(!1)):(a(!1),u(!0)),i(!1)}()},[e]),o)?(0,s.jsx)("p",{children:"Cargando..."}):t||l?l?(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background text-white p-4",children:[(0,s.jsx)("h2",{className:"text-2xl mb-4",children:"Tu tiempo de acceso ha expirado."}),(0,s.jsx)("p",{className:"mb-6",children:"Para continuar usando la plataforma, debes hacer un nuevo dep\xf3sito de 500 pesos."}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:b,className:"btn-primary px-6 py-2 rounded",children:"Continuar"}),(0,s.jsx)("button",{onClick:function(){a(!1),u(!1)},className:"btn-outline px-6 py-2 rounded",children:"Salir"})]})]}):(0,s.jsxs)("main",{className:"min-h-screen flex flex-col items-center justify-center bg-background text-white p-4",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Solicitudes Eventuales"}),(0,s.jsx)(c,{})]}):(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background text-white p-4",children:[(0,s.jsx)("h2",{className:"text-2xl mb-4",children:"Deposita 500 pesos para activar tu acceso"}),(0,s.jsx)("input",{type:"tel",placeholder:"Tu tel\xe9fono",value:p,onChange:e=>h(e.target.value),className:"mb-4 p-2 rounded text-black"}),f&&(0,s.jsx)("p",{className:"text-red-500 mb-4",children:f}),(0,s.jsx)("button",{onClick:b,className:"btn-primary px-6 py-2 rounded",children:"Activar acceso"})]})}},83722:(e,t,a)=>{Promise.resolve().then(a.bind(a,73434))},84105:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,O:()=>l});var s=a(95155),r=a(12115),n=a(9650),o=a(93004);let i=(0,r.createContext)(void 0),l=e=>{let{children:t}=e,[a,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[d,m]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=(0,o.hg)(n.j2,async e=>{if(h(!0),e){l(e),u(["erolando134@gmail.com","ortegakarelia5@gmail.com"].includes(e.email||""));try{let t=await e.getIdTokenResult();m(!!t.claims.supervisor)}catch(e){console.error("Error getting supervisor claim:",e),m(!1)}}else l(null),u(!1),m(!1);h(!1)});return()=>e()},[]),(0,s.jsx)(i.Provider,{value:{user:a,isAdmin:c,isSupervisor:d,loading:p,login:(e,t)=>(0,o.x9)(n.j2,e,t),logout:()=>(0,o.CI)(n.j2)},children:t})},c=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},87481:(e,t,a)=>{"use strict";a.d(t,{d:()=>d,o:()=>u});var s=a(12115);let r=0,n=new Map,o=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e4);n.set(e,t)},i=[],l={toasts:[]};function c(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?o(a):e.toasts.forEach(e=>o(e.id)),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};default:return e}})(l,e),i.forEach(e=>e(l))}function u(e){let t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function d(){let[e,t]=s.useState(l);return s.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{e.O(0,[2992,7138,8248,9398,8441,5964,7358],()=>e(e.s=83722)),_N_E=e.O()}]);